<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Probability plot using the exponential reduced variate | A drought book thing</title>
  <meta name="description" content="Test description." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Probability plot using the exponential reduced variate | A drought book thing" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bookdown.org/yihui/rmarkdown/" />
  <meta property="og:image" content="https://bookdown.org/yihui/rmarkdown/images/logo/logo-rstudio4edu.png" />
  <meta property="og:description" content="Test description." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Probability plot using the exponential reduced variate | A drought book thing" />
  
  <meta name="twitter:description" content="Test description." />
  <meta name="twitter:image" content="https://bookdown.org/yihui/rmarkdown/images/logo/logo-rstudio4edu.png" />

<meta name="author" content="Jim Stagge" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-6.html"/>

<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">This title is in _output</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="chapter-1-no-examples.html"><a href="chapter-1-no-examples.html"><i class="fa fa-check"></i><b>1</b> Chapter 1 - No Examples</a></li>
<li class="chapter" data-level="2" data-path="chapter-2-no-examples.html"><a href="chapter-2-no-examples.html"><i class="fa fa-check"></i><b>2</b> Chapter 2 - No Examples</a></li>
<li class="chapter" data-level="3" data-path="chapter-3-no-examples.html"><a href="chapter-3-no-examples.html"><i class="fa fa-check"></i><b>3</b> Chapter 3 - No Examples</a></li>
<li class="chapter" data-level="4" data-path="chapter-4-no-examples.html"><a href="chapter-4-no-examples.html"><i class="fa fa-check"></i><b>4</b> Chapter 4 - No Examples</a></li>
<li class="chapter" data-level="5" data-path="chapter-5.html"><a href="chapter-5.html"><i class="fa fa-check"></i><b>5</b> Chapter 5</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.1-flow-duration-curve"><i class="fa fa-check"></i><b>5.1</b> Worked Example 5.1: Flow Duration Curve</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="chapter-5.html"><a href="chapter-5.html#loading-the-data"><i class="fa fa-check"></i><b>5.1.1</b> Loading the Data</a></li>
<li class="chapter" data-level="5.1.2" data-path="chapter-5.html"><a href="chapter-5.html#calculation-of-the-fdc"><i class="fa fa-check"></i><b>5.1.2</b> Calculation of the FDC</a></li>
<li class="chapter" data-level="5.1.3" data-path="chapter-5.html"><a href="chapter-5.html#plot-of-the-fdc"><i class="fa fa-check"></i><b>5.1.3</b> Plot of the FDC</a></li>
<li class="chapter" data-level="5.1.4" data-path="chapter-5.html"><a href="chapter-5.html#selected-exceedance-values"><i class="fa fa-check"></i><b>5.1.4</b> Selected exceedance values</a></li>
<li class="chapter" data-level="5.1.5" data-path="chapter-5.html"><a href="chapter-5.html#fast-track"><i class="fa fa-check"></i><b>5.1.5</b> Fast-Track</a></li>
<li class="chapter" data-level="5.1.6" data-path="chapter-5.html"><a href="chapter-5.html#standardized-flow-duration-curves"><i class="fa fa-check"></i><b>5.1.6</b> Standardized Flow Duration Curves</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.2-mean-annual-minimum-n-day-flow"><i class="fa fa-check"></i><b>5.2</b> Worked example 5.2: Mean annual minimum n-day flow</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chapter-5.html"><a href="chapter-5.html#loading-the-data-1"><i class="fa fa-check"></i><b>5.2.1</b> Loading the Data</a></li>
<li class="chapter" data-level="5.2.2" data-path="chapter-5.html"><a href="chapter-5.html#calculation"><i class="fa fa-check"></i><b>5.2.2</b> Calculation</a></li>
<li class="chapter" data-level="5.2.3" data-path="chapter-5.html"><a href="chapter-5.html#fast-track-1"><i class="fa fa-check"></i><b>5.2.3</b> Fast Track</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.3-base-flow-index"><i class="fa fa-check"></i><b>5.3</b> Worked Example 5.3: Base Flow Index</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chapter-5.html"><a href="chapter-5.html#loading-the-data-2"><i class="fa fa-check"></i><b>5.3.1</b> Loading the Data</a></li>
<li class="chapter" data-level="5.3.2" data-path="chapter-5.html"><a href="chapter-5.html#calculation-1"><i class="fa fa-check"></i><b>5.3.2</b> Calculation</a></li>
<li class="chapter" data-level="5.3.3" data-path="chapter-5.html"><a href="chapter-5.html#results"><i class="fa fa-check"></i><b>5.3.3</b> Results</a></li>
<li class="chapter" data-level="5.3.4" data-path="chapter-5.html"><a href="chapter-5.html#fast-track-2"><i class="fa fa-check"></i><b>5.3.4</b> Fast Track</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.4-threshold-level-method"><i class="fa fa-check"></i><b>5.4</b> Worked example 5.4: Threshold level method</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chapter-5.html"><a href="chapter-5.html#loading-the-data-3"><i class="fa fa-check"></i><b>5.4.1</b> Loading the Data</a></li>
<li class="chapter" data-level="5.4.2" data-path="chapter-5.html"><a href="chapter-5.html#missing-values"><i class="fa fa-check"></i><b>5.4.2</b> Missing values</a></li>
<li class="chapter" data-level="5.4.3" data-path="chapter-5.html"><a href="chapter-5.html#threshold-selection-and-drought-events"><i class="fa fa-check"></i><b>5.4.3</b> Threshold selection and drought events</a></li>
<li class="chapter" data-level="5.4.4" data-path="chapter-5.html"><a href="chapter-5.html#removing-minor-droughts-filtering"><i class="fa fa-check"></i><b>5.4.4</b> Removing minor droughts (Filtering)</a></li>
<li class="chapter" data-level="5.4.5" data-path="chapter-5.html"><a href="chapter-5.html#eliminating-dependent-droughts-pooling"><i class="fa fa-check"></i><b>5.4.5</b> Eliminating dependent droughts (Pooling)</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.5-sequent-peak-algorithm"><i class="fa fa-check"></i><b>5.5</b> Worked example 5.5: Sequent Peak Algorithm</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="chapter-5.html"><a href="chapter-5.html#loading-the-data-4"><i class="fa fa-check"></i><b>5.5.1</b> Loading the Data</a></li>
<li class="chapter" data-level="5.5.2" data-path="chapter-5.html"><a href="chapter-5.html#calculation-2"><i class="fa fa-check"></i><b>5.5.2</b> Calculation</a></li>
<li class="chapter" data-level="5.5.3" data-path="chapter-5.html"><a href="chapter-5.html#selection-of-the-drought-deficit-volume-and-duration"><i class="fa fa-check"></i><b>5.5.3</b> Selection of the drought deficit volume and duration</a></li>
<li class="chapter" data-level="5.5.4" data-path="chapter-5.html"><a href="chapter-5.html#results-1"><i class="fa fa-check"></i><b>5.5.4</b> Results</a></li>
<li class="chapter" data-level="5.5.5" data-path="chapter-5.html"><a href="chapter-5.html#fast-track-3"><i class="fa fa-check"></i><b>5.5.5</b> Fast Track</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.6-example-of-how-to-estimate-sgi-using-data-from-stonor-park-uk"><i class="fa fa-check"></i><b>5.6</b> Worked example 5.6, Example of how to estimate SGI using data from Stonor Park, UK</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="chapter-5.html"><a href="chapter-5.html#load-the-data"><i class="fa fa-check"></i><b>5.6.1</b> Load the data</a></li>
<li class="chapter" data-level="5.6.2" data-path="chapter-5.html"><a href="chapter-5.html#create-a-regular-times-series-of-monthly-data"><i class="fa fa-check"></i><b>5.6.2</b> Create a regular times series of monthly data</a></li>
<li class="chapter" data-level="5.6.3" data-path="chapter-5.html"><a href="chapter-5.html#calculate-an-sgi-values"><i class="fa fa-check"></i><b>5.6.3</b> Calculate an SGI values</a></li>
<li class="chapter" data-level="5.6.4" data-path="chapter-5.html"><a href="chapter-5.html#fast-track-4"><i class="fa fa-check"></i><b>5.6.4</b> Fast-Track</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.7-rank-and-correlation-coefficients"><i class="fa fa-check"></i><b>5.7</b> Worked example 5.7: Rank and correlation coefficients</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="chapter-5.html"><a href="chapter-5.html#loading-the-data-5"><i class="fa fa-check"></i><b>5.7.1</b> Loading the Data</a></li>
<li class="chapter" data-level="5.7.2" data-path="chapter-5.html"><a href="chapter-5.html#indices"><i class="fa fa-check"></i><b>5.7.2</b> Indices</a></li>
<li class="chapter" data-level="5.7.3" data-path="chapter-5.html"><a href="chapter-5.html#ranks"><i class="fa fa-check"></i><b>5.7.3</b> Ranks</a></li>
<li class="chapter" data-level="5.7.4" data-path="chapter-5.html"><a href="chapter-5.html#pearson-correlation"><i class="fa fa-check"></i><b>5.7.4</b> Pearson correlation</a></li>
<li class="chapter" data-level="5.7.5" data-path="chapter-5.html"><a href="chapter-5.html#spearman-rank-correlation"><i class="fa fa-check"></i><b>5.7.5</b> Spearman (rank) correlation</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.8-no-flow-indices"><i class="fa fa-check"></i><b>5.8</b> Worked example 5.8: No-flow indices</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="chapter-5.html"><a href="chapter-5.html#loading-the-data-6"><i class="fa fa-check"></i><b>5.8.1</b> Loading the Data</a></li>
<li class="chapter" data-level="5.8.2" data-path="chapter-5.html"><a href="chapter-5.html#finding-intermittent-rivers"><i class="fa fa-check"></i><b>5.8.2</b> Finding intermittent rivers</a></li>
<li class="chapter" data-level="5.8.3" data-path="chapter-5.html"><a href="chapter-5.html#computing-metrics"><i class="fa fa-check"></i><b>5.8.3</b> Computing metrics</a></li>
<li class="chapter" data-level="5.8.4" data-path="chapter-5.html"><a href="chapter-5.html#visualising-streamflow-permanence-spells"><i class="fa fa-check"></i><b>5.8.4</b> Visualising streamflow permanence (spells)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter-6.html"><a href="chapter-6.html"><i class="fa fa-check"></i><b>6</b> Chapter 6</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter-6.html"><a href="chapter-6.html#worked-example-6.1-low-flow-frequency-analysis"><i class="fa fa-check"></i><b>6.1</b> Worked Example 6.1: Low flow frequency analysis</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chapter-6.html"><a href="chapter-6.html#loading-the-data-7"><i class="fa fa-check"></i><b>6.1.1</b> Loading the Data</a></li>
<li class="chapter" data-level="6.1.2" data-path="chapter-6.html"><a href="chapter-6.html#derivation-of-an-empirical-distribution-function"><i class="fa fa-check"></i><b>6.1.2</b> Derivation of an empirical distribution function</a></li>
<li class="chapter" data-level="6.1.3" data-path="chapter-6.html"><a href="chapter-6.html#fitting-a-distribution"><i class="fa fa-check"></i><b>6.1.3</b> Fitting a distribution</a></li>
<li class="chapter" data-level="6.1.4" data-path="chapter-6.html"><a href="chapter-6.html#estimation-of-t-year-events"><i class="fa fa-check"></i><b>6.1.4</b> Estimation of T-year events</a></li>
<li class="chapter" data-level="6.1.5" data-path="chapter-6.html"><a href="chapter-6.html#ft"><i class="fa fa-check"></i><b>6.1.5</b> Fast Track</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="probability-plot-using-the-exponential-reduced-variate.html"><a href="probability-plot-using-the-exponential-reduced-variate.html"><i class="fa fa-check"></i><b>7</b> Probability plot using the exponential reduced variate</a>
<ul>
<li class="chapter" data-level="7.1" data-path="probability-plot-using-the-exponential-reduced-variate.html"><a href="probability-plot-using-the-exponential-reduced-variate.html#worked-example-6.2-drought-deficit-frequency-analysis"><i class="fa fa-check"></i><b>7.1</b> Worked Example 6.2: Drought deficit frequency analysis</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="probability-plot-using-the-exponential-reduced-variate.html"><a href="probability-plot-using-the-exponential-reduced-variate.html#data"><i class="fa fa-check"></i><b>7.1.1</b> Data</a></li>
<li class="chapter" data-level="7.1.2" data-path="probability-plot-using-the-exponential-reduced-variate.html"><a href="probability-plot-using-the-exponential-reduced-variate.html#derivation-of-distribution-function"><i class="fa fa-check"></i><b>7.1.2</b> Derivation of distribution function</a></li>
<li class="chapter" data-level="7.1.3" data-path="probability-plot-using-the-exponential-reduced-variate.html"><a href="probability-plot-using-the-exponential-reduced-variate.html#calculation-of-the-t-year-event"><i class="fa fa-check"></i><b>7.1.3</b> Calculation of the T-year event</a></li>
<li class="chapter" data-level="7.1.4" data-path="probability-plot-using-the-exponential-reduced-variate.html"><a href="probability-plot-using-the-exponential-reduced-variate.html#manual-computation"><i class="fa fa-check"></i><b>7.1.4</b> Manual computation</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio4edu/rstudio4edu-book" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A drought book thing</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="probability-plot-using-the-exponential-reduced-variate" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Probability plot using the exponential reduced variate</h1>
<p>The two-parameter EXP (Equation A6.1.64) and the WEI distribution are compared
using the exponential reduced variable (Box 6.4).</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb105-1" aria-hidden="true" tabindex="-1"></a>fitted.fast <span class="ot">&lt;-</span> am <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb105-3"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb105-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob.emp =</span> <span class="fu">rank</span>(flow) <span class="sc">/</span> (<span class="fu">n</span>() <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb105-4"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob.wei =</span> <span class="fu">cdfwei</span>(<span class="at">x =</span> flow, <span class="at">para =</span> <span class="fu">pelwei</span>(lmom, <span class="at">bound =</span> <span class="dv">0</span>)),</span>
<span id="cb105-5"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob.exp =</span> <span class="fu">cdfexp</span>(<span class="at">x =</span> flow, <span class="at">para =</span> <span class="fu">pelexp</span>(lmom))</span>
<span id="cb105-6"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb105-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb105-7"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(flow) <span class="sc">%&gt;%</span></span>
<span id="cb105-8"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 50 x 5
##     year  flow prob.emp prob.wei prob.exp
##    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1  2014  2.17   0.0196   0.0472   0     
##  2  2012  2.34   0.0392   0.0644   0     
##  3  1982  2.46   0.0588   0.0806   0     
##  4  2008  2.53   0.0784   0.0913   0     
##  5  1977  2.59   0.0980   0.101    0     
##  6  2007  2.64   0.118    0.109    0     
##  7  1972  2.66   0.137    0.113    0     
##  8  2004  2.68   0.157    0.115    0     
##  9  1973  2.88   0.176    0.158    0.0876
## 10  2003  2.99   0.196    0.184    0.173 
## # … with 40 more rows</code></pre>
<ol style="list-style-type: lower-alpha">
<li><p>By substituting <span class="math inline">\(y\)</span> into the expression for <span class="math inline">\(F(x)\)</span>, <span class="math inline">\(y\)</span> can be
expressed as <span class="math inline">\(-\ln(1 - F(x))\)</span> (Equation B6.4.6). The parameters of the
EXP distribution are estimated using L-moments (Equation A6.1.72)
and used to calculate <span class="math inline">\(y\)</span> and subsequently, <span class="math inline">\(F(x)\)</span>.</p></li>
<li><p>The non-exceedance probability <span class="math inline">\(F(x)\)</span> for the observations is
determined using the Weibull plotting position formula
(Equation 6.6).</p></li>
<li><p>The <span class="math inline">\(AM(1)\)</span> values are plotted against the reduced variate in
Figure 6.11. A reduced variate of <span class="math inline">\(0.02\)</span> corresponds to a return period
of <span class="math inline">\(50.5\)</span> years for minimum values (Equation 6.5). The data will plot as
a straight line given they follow the EXP distribution. Again it is
demonstrated that the WEI distribution fits the extreme low flow
values well, and also the upper range apart from the three largest
values. The two-parameter EXP distribution is less suited to model the
sample. Alternatively, <span class="math inline">\(-\ln(X)\)</span> could be plotted on a Gumbel
probability paper, and a straight line would result provided the data
fitted the WEI distribution.</p></li>
</ol>
<div class="figure"><span id="fig:unnamed-chunk-91"></span>
<img src="_main_files/figure-html/unnamed-chunk-91-1.png" alt="Figure 6.11: The annual minimum 1-day flow, AM(1), plotted against the reduced variate, y, of the EXP distribution for River Ngaruroro at Kuripapango (NZ); the observations (marked as points), the two-parameter EXP distribution (continous line) and the two-parameter WEI distribution (dashed line)." width="672" />
<p class="caption">
Figure 7.1: Figure 6.11: The annual minimum 1-day flow, AM(1), plotted against the reduced variate, y, of the EXP distribution for River Ngaruroro at Kuripapango (NZ); the observations (marked as points), the two-parameter EXP distribution (continous line) and the two-parameter WEI distribution (dashed line).
</p>
</div>
<div id="worked-example-6.2-drought-deficit-frequency-analysis" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Worked Example 6.2: Drought deficit frequency analysis</h2>
<div id="data" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Data</h3>
<p>River Ngaruroro at Kuripapango in New Zealand, applied for frequency
analysis of annual minimum series in Worked Example 6.1, is here applied
for frequency analysis of drought deficit characteristics.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb107-2"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hydroDrought)</span>
<span id="cb107-3"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb107-4" aria-hidden="true" tabindex="-1"></a>pooled</span></code></pre></div>
<pre><code>## # A tibble: 100 x 5
##    event  year first.day  duration volume
##    &lt;int&gt; &lt;dbl&gt; &lt;date&gt;        &lt;dbl&gt;  &lt;dbl&gt;
##  1     7  1967 1968-02-17       21  1767.
##  2     8  1967 1968-03-11       23  2350.
##  3    10  1968 1969-03-25        9   197.
##  4    11  1968 1969-04-06       13   786.
##  5    13  1969 1969-11-17        6   241.
##  6    15  1969 1970-01-25       14   578.
##  7    16  1969 1970-02-28       17   981.
##  8    17  1970 1970-12-08        7   130.
##  9    24  1970 1972-02-03        7   297.
## 10    25  1970 1972-02-13       20  1394.
## # … with 90 more rows</code></pre>
<p>The pooled drought events obtained in Worked Example 5.4 (Section 5.4.1) can be
concieved as a partial duration series (PDS)
because after removing 77 minor droughts only
100 events above and equal to the following thresholds remained
in the series.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb109-1" aria-hidden="true" tabindex="-1"></a>threshold </span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   metric   threshold
##   &lt;chr&gt;        &lt;dbl&gt;
## 1 duration         5
## 2 volume          51</code></pre>
<p>Two drought characteristics are analysed in the following: drought deficit
volume and real drought duration as defined in Worked Example 5.4.</p>
<p>Drought events were selected for River Ngaruroro and details of the
selection criteria are given in Worked Example 5.4. The series cover the
period 1964 to 2018 and the start of the
year is set to 1 September.</p>
<p>A total of eight years were omitted from the series,
1963/64, 1965/66, 1977/78, 1978/79, 1986/87, 1987/88, 2001/02 and 2019/20,
due to missing data. As a result 49 years remained in the dataset.</p>
<p>As only events below the <span class="math inline">\(Q_{90}\)</span>
percentile are selected, it might happen that the flow never becomes less
than the threshold in a year (non-drought year).</p>
<p>A total of five out of the
49 years with observations did not experience a drought
(34.7%). The PDS
series of drought deficit volume and real duration are plotted in
Figure 6.12. Less severe values are found in the second half of the
observation period for both deficit volume (upper) and duration (lower).
The data are still treated as one sample as the number of observations is
considered insufficient for a separate analysis of two periods. It should
further be noted that a similar trend towards less severe droughts is not as
pronounced for the <span class="math inline">\(AM(1)\)</span> values (Worked Example 6.1). This is likely a
result of the high base flow contribution in the catchment (Figure 6.6).</p>
<div class="figure"><span id="fig:unnamed-chunk-96"></span>
<img src="_main_files/figure-html/unnamed-chunk-96-1.png" alt="Figure 6.12 PDS of drought deficit volume (upper) and real duration (lower) for River
Ngaruroro at Kuripapango (NZ)." width="672" />
<p class="caption">
Figure 7.2: Figure 6.12 PDS of drought deficit volume (upper) and real duration (lower) for River
Ngaruroro at Kuripapango (NZ).
</p>
</div>
</div>
<div id="derivation-of-distribution-function" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Derivation of distribution function</h3>
<p>in the <a href="https://www.jstatsoft.org/index.php/jss/article/view/v072i08/v72i08.pdf">Journal of Statistical Software</a> there is an article describing the extremes package.</p>
<p>Their approach is identical to Equation 6.11 in the first edition of the book.</p>
<blockquote>
<p>“The quantiles of the GP df are easily obtained by setting Equation 5 equal to
<span class="math inline">\(1 - p\)</span> and inverting. However, the quantiles of the GP df cannot be as readily interpreted as
return levels because the data no longer derive from specific blocks of equal length. Instead,
an estimate of the probability of exceeding the threshold, e.g., called <span class="math inline">\(\zeta_u\)</span> , is required. Then,
the value <span class="math inline">\(x_m\)</span> that is exceeded on average once every <span class="math inline">\(m\)</span> observations (i.e., an estimated return
level) is”</p>
</blockquote>
<p><span class="math display">\[ x_m = u + \frac{\sigma_u}{\xi} \left[ (m \zeta_u)^\xi - 1\right] \]</span>
with <span class="math inline">\(m\)</span> being the return period and <span class="math inline">\(\zeta_u\)</span> the overall exceedance rate (= average number of exceedances
per year). So the return period is just multiplied with the exceedance rate.
<span class="math inline">\(u\)</span> is the location parameter of the GPA (= threshold), <span class="math inline">\(\sigma_u\)</span> is scale and <span class="math inline">\(\xi\)</span> is shape.
In our case <span class="math inline">\(\zeta_u = \frac{\text{length of PDS}}{\text{record length in years}}\)</span>.</p>
<p>This transformation will introduce return periods of less than a year (or negative
probabilities) for values <span class="math inline">\(P_{PDS} &lt; 1 + \zeta_u\)</span>. Return periods for PDS of less
than a year just imply that such an event occurs on average several times a year.</p>
<p><span class="math display">\[P_{annual} = 1 - \frac{(1 - P_{PDS})}{\zeta_u}\]</span></p>
<p>I’ve seen PDS return periods &lt; 1 for example in <a href="https://iwaponline.com/hr/article/8/1/57/1454/Return-Periods-of-Hydrological-EventsPaper">Return Periods of Hydrological Events, Rojsberg 1976</a>. I’ve also looked at his approach of relating PDS and AMS. But for return periods &gt; 10 years quantiles of the AMS and PDS are practically identical, irrespective of the exceedance rate.</p>
<p>Following Zelenhasic &amp; Salvai (1987) an estimate of the non-exceedance
probability, <span class="math inline">\(F(x)\)</span>, for the largest event in each time interval is in Nizowka
obtained by combining the distribution for the occurrence of events and
the distribution for the magnitudes of deficit volume or duration. Here a
time interval of one year is chosen. Subsequently the return period in
years for a given event can be calculated. The number of drought events
occurring in a time period t is commonly assumed to be Poisson
distributed (Equation 6.9) with parameter <span class="math inline">\(\lambda t\)</span>. In Nizowka the binomial
Pascal distribution is offered along with the Poisson distribution as
described in ‘Background Information NIZOWKA’ (Software, CD). The
distribution that best fitted deficit volume was the Pascal distribution for
the number of droughts and the GP distribution for the deficits. For
duration the Pascal distribution was chosen along with the Log-Normal
distribution. The <span class="math inline">\(F(x)\)</span> is for drought deficit volume plotted in Figure 6.13
together with the observed values plotted using a plotting position. The
chosen distribution describes the data well, with the exception of some
values in the upper range. The maximum value is, however, satisfactorily
modelled.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmom)</span>
<span id="cb111-2"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-2" aria-hidden="true" tabindex="-1"></a>rp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">200</span>)</span>
<span id="cb111-3"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-3" aria-hidden="true" tabindex="-1"></a>prob.annual <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">/</span> rp)</span>
<span id="cb111-4"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-5" aria-hidden="true" tabindex="-1"></a>annual2pds <span class="ot">&lt;-</span> <span class="cf">function</span>(prob.annual, exc.per.year) {</span>
<span id="cb111-6"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> prob.annual)<span class="sc">/</span>exc.per.year</span>
<span id="cb111-7"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-8"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-9"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-9" aria-hidden="true" tabindex="-1"></a>pds2annual <span class="ot">&lt;-</span> <span class="cf">function</span>(prob.pds, exc.per.year) {</span>
<span id="cb111-10"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> prob.pds) <span class="sc">*</span> exc.per.year</span>
<span id="cb111-11"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-12"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-13"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-13" aria-hidden="true" tabindex="-1"></a>observations <span class="ot">&lt;-</span> pooled <span class="sc">%&gt;%</span> </span>
<span id="cb111-14"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(duration, volume) <span class="sc">%&gt;%</span></span>
<span id="cb111-15"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb111-16"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-17"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> value)  <span class="sc">%&gt;%</span></span>
<span id="cb111-18"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(threshold, <span class="at">by =</span> <span class="st">&quot;metric&quot;</span>) </span>
<span id="cb111-19"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-20"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-20" aria-hidden="true" tabindex="-1"></a>fitted <span class="ot">&lt;-</span> observations <span class="sc">%&gt;%</span> </span>
<span id="cb111-21"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb111-22"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate =</span> <span class="fu">map2_dbl</span>(data, data, <span class="sc">~</span>(<span class="fu">nrow</span>(.x) <span class="sc">/</span> <span class="fu">nrow</span>(complete))), </span>
<span id="cb111-23"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameter =</span> <span class="fu">map2</span>(data, threshold, <span class="sc">~</span><span class="fu">pelgpa</span>(<span class="fu">samlmu</span>(.x<span class="sc">$</span>value), <span class="at">bound =</span> .y))</span>
<span id="cb111-24"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb111-25"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb111-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   metric   data               threshold  rate parameter
##   &lt;chr&gt;    &lt;list&gt;                 &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;   
## 1 duration &lt;tibble [100 × 1]&gt;         5  2.04 &lt;dbl [3]&gt;
## 2 volume   &lt;tibble [100 × 1]&gt;        51  2.04 &lt;dbl [3]&gt;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
</div>
<div id="calculation-of-the-t-year-event" class="section level3" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Calculation of the T-year event</h3>
<p>The return period of a given event is calculated following Equation 6.4.
The relationship between the drought characteristics as defined in Worked
Example 5.4 and <span class="math inline">\(F(x)\)</span> are given by the tabulated distribution functions in
Nizowka. The design value for a particular return period, i.e. the T-year
event, can be obtained from the tables for known values of <span class="math inline">\(F(x)\)</span>. The
estimated 10-, 100- and 200-year drought events are shown in Table 6.2.</p>
<pre><code>## # A tibble: 3 x 6
##   prob.annual rp.annual rp.pds prob.pds duration volume
##         &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1       0.9         10.   20.4    0.951     42.1  4841.
## 2       0.99       100.  204.     0.995     91.7 15995.
## 3       0.995      200.  408.     0.998    112.  22159.</code></pre>
</div>
<div id="manual-computation" class="section level3" number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> Manual computation</h3>
<p>Tobias: pearhaps mention that one should not forget to set the lower bound of the GPA (location parameter) equal to the threshold.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb114-1" aria-hidden="true" tabindex="-1"></a>(parameter <span class="ot">&lt;-</span> <span class="fu">pelgpa</span>(<span class="fu">samlmu</span>(pooled<span class="sc">$</span>duration), <span class="at">bound =</span> <span class="dv">5</span>))</span></code></pre></div>
<pre><code>##         xi      alpha          k 
##  5.0000000  8.7770258 -0.2128228</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb116-1" aria-hidden="true" tabindex="-1"></a>prob.annual <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">200</span>)</span>
<span id="cb116-2"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb116-2" aria-hidden="true" tabindex="-1"></a>prob.pds <span class="ot">&lt;-</span> <span class="fu">annual2pds</span>(prob.annual, <span class="at">exc.per.year =</span> <span class="dv">100</span> <span class="sc">/</span> <span class="dv">49</span>)</span>
<span id="cb116-3"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantiles of the GPA </span></span>
<span id="cb116-5"><a href="probability-plot-using-the-exponential-reduced-variate.html#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="fu">quagpa</span>(<span class="at">f =</span> prob.pds, <span class="at">para =</span> parameter)</span></code></pre></div>
<pre><code>## [1]  42.11736  91.67007 112.00200</code></pre>

</div>
</div>
</div>






            </section>

          </div>
        </div>
      </div>
<a href="chapter-6.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio4edu/rstudio4edu-book/edit/master/06-chapter6.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/rstudio4edu/rstudio4edu-book/raw/master/06-chapter6.Rmd"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
