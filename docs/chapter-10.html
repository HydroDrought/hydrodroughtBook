<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 | Hydrological Drought (2nd Edition)</title>
  <meta name="description" content="Worked examples for Hydrologic Drought: Processes and Estimation Methods for Streamflow and Groundwater (2nd Edition)" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 | Hydrological Drought (2nd Edition)" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/jstagge/hydroDrought/docs" />
  
  <meta property="og:description" content="Worked examples for Hydrologic Drought: Processes and Estimation Methods for Streamflow and Groundwater (2nd Edition)" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 | Hydrological Drought (2nd Edition)" />
  
  <meta name="twitter:description" content="Worked examples for Hydrologic Drought: Processes and Estimation Methods for Streamflow and Groundwater (2nd Edition)" />
  

<meta name="author" content="Jim Stagge" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-7.html"/>
<link rel="next" href="chapter-12.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><b><a href="./">Hydrologic Drought </a></b>2nd Edition</li>
<a href="./">Tallaksen and van Lanen (2021) </a>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html"><i class="fa fa-check"></i>Chapter 5</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.1-flow-duration-curve"><i class="fa fa-check"></i>Worked Example 5.1: Flow Duration Curve</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#loading-the-data"><i class="fa fa-check"></i>Loading the Data</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#calculation-of-the-fdc"><i class="fa fa-check"></i>Calculation of the FDC</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#plot-of-the-fdc"><i class="fa fa-check"></i>Plot of the FDC</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#selected-exceedance-values"><i class="fa fa-check"></i>Selected exceedance values</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#fast-track"><i class="fa fa-check"></i>Fast-Track</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#standardized-flow-duration-curves"><i class="fa fa-check"></i>Standardized Flow Duration Curves</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.2-mean-annual-minimum-n-day-flow"><i class="fa fa-check"></i>Worked example 5.2: Mean annual minimum n-day flow</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#loading-the-data-1"><i class="fa fa-check"></i>Loading the Data</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#calculation"><i class="fa fa-check"></i>Calculation</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#fast-track-1"><i class="fa fa-check"></i>Fast Track</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.3-base-flow-index"><i class="fa fa-check"></i>Worked Example 5.3: Base Flow Index</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#loading-the-data-2"><i class="fa fa-check"></i>Loading the Data</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#calculation-1"><i class="fa fa-check"></i>Calculation</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#fast-track-2"><i class="fa fa-check"></i>Fast Track</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.4-threshold-level-method"><i class="fa fa-check"></i>Worked example 5.4: Threshold level method</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#loading-the-data-3"><i class="fa fa-check"></i>Loading the Data</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#missing-values"><i class="fa fa-check"></i>Missing values</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#threshold-selection-and-drought-events"><i class="fa fa-check"></i>Threshold selection and drought events</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#removing-minor-droughts-filtering"><i class="fa fa-check"></i>Removing minor droughts (Filtering)</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#eliminating-dependent-droughts-pooling"><i class="fa fa-check"></i>Eliminating dependent droughts (Pooling)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.5-sequent-peak-algorithm"><i class="fa fa-check"></i>Worked example 5.5: Sequent Peak Algorithm</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#loading-the-data-4"><i class="fa fa-check"></i>Loading the Data</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#calculation-2"><i class="fa fa-check"></i>Calculation</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#selection-of-the-drought-deficit-volume-and-duration"><i class="fa fa-check"></i>Selection of the drought deficit volume and duration</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#results-1"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#fast-track-3"><i class="fa fa-check"></i>Fast Track</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.6-example-of-how-to-estimate-sgi-using-data-from-stonor-park-uk"><i class="fa fa-check"></i>Worked example 5.6, Example of how to estimate SGI using data from Stonor Park, UK</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#load-the-data"><i class="fa fa-check"></i>Load the data</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#create-a-regular-times-series-of-monthly-data"><i class="fa fa-check"></i>Create a regular times series of monthly data</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#calculate-an-sgi-values"><i class="fa fa-check"></i>Calculate an SGI values</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#fast-track-4"><i class="fa fa-check"></i>Fast-Track</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.7-rank-and-correlation-coefficients"><i class="fa fa-check"></i>Worked example 5.7: Rank and correlation coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#loading-the-data-5"><i class="fa fa-check"></i>Loading the Data</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#indices"><i class="fa fa-check"></i>Indices</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#ranks"><i class="fa fa-check"></i>Ranks</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#pearson-correlation"><i class="fa fa-check"></i>Pearson correlation</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#spearman-rank-correlation"><i class="fa fa-check"></i>Spearman (rank) correlation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#worked-example-5.8-no-flow-indices"><i class="fa fa-check"></i>Worked example 5.8: No-flow indices</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#loading-the-data-6"><i class="fa fa-check"></i>Loading the Data</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#finding-intermittent-rivers"><i class="fa fa-check"></i>Finding intermittent rivers</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#computing-metrics"><i class="fa fa-check"></i>Computing metrics</a></li>
<li class="chapter" data-level="" data-path="chapter-5.html"><a href="chapter-5.html#visualising-streamflow-permanence-spells"><i class="fa fa-check"></i>Visualising streamflow permanence (spells)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-6.html"><a href="chapter-6.html"><i class="fa fa-check"></i>Chapter 6</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-6.html"><a href="chapter-6.html#worked-example-6.1-low-flow-frequency-analysis"><i class="fa fa-check"></i>Worked Example 6.1: Low flow frequency analysis</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-6.html"><a href="chapter-6.html#loading-the-data-7"><i class="fa fa-check"></i>Loading the Data</a></li>
<li class="chapter" data-level="" data-path="chapter-6.html"><a href="chapter-6.html#derivation-of-an-empirical-distribution-function"><i class="fa fa-check"></i>Derivation of an empirical distribution function</a></li>
<li class="chapter" data-level="" data-path="chapter-6.html"><a href="chapter-6.html#fitting-a-distribution"><i class="fa fa-check"></i>Fitting a distribution</a></li>
<li class="chapter" data-level="" data-path="chapter-6.html"><a href="chapter-6.html#estimation-of-t-year-events"><i class="fa fa-check"></i>Estimation of T-year events</a></li>
<li class="chapter" data-level="" data-path="chapter-6.html"><a href="chapter-6.html#ft"><i class="fa fa-check"></i>Fast Track</a></li>
<li class="chapter" data-level="" data-path="chapter-6.html"><a href="chapter-6.html#probability-plot-using-the-exponential-reduced-variate"><i class="fa fa-check"></i>Probability plot using the exponential reduced variate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-6.html"><a href="chapter-6.html#worked-example-6.2-drought-deficit-frequency-analysis"><i class="fa fa-check"></i>Worked Example 6.2: Drought deficit frequency analysis</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-6.html"><a href="chapter-6.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="chapter-6.html"><a href="chapter-6.html#derivation-of-distribution-function"><i class="fa fa-check"></i>Derivation of distribution function</a></li>
<li class="chapter" data-level="" data-path="chapter-6.html"><a href="chapter-6.html#calculation-of-the-t-year-event"><i class="fa fa-check"></i>Calculation of the T-year event</a></li>
<li class="chapter" data-level="" data-path="chapter-6.html"><a href="chapter-6.html#manual-computation"><i class="fa fa-check"></i>Manual computation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html"><i class="fa fa-check"></i>Chapter 7</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html#worked-example-7.1-linear-trend-analysis"><i class="fa fa-check"></i>Worked example 7.1: Linear trend analysis</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html#loading-the-data-8"><i class="fa fa-check"></i>Loading the Data</a></li>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html#linear-trend-for-elbe-river"><i class="fa fa-check"></i>Linear trend for Elbe River</a></li>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html#linear-trend-for-göta-river"><i class="fa fa-check"></i>Linear trend for Göta River</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html#worked-example-7.2-non-parametric-trends"><i class="fa fa-check"></i>Worked Example 7.2: Non Parametric Trends</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html#loading-the-data-9"><i class="fa fa-check"></i>Loading the Data</a></li>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html#mann-kendall-test"><i class="fa fa-check"></i>Mann-Kendall test</a></li>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html#high-leverage-outlier-effects"><i class="fa fa-check"></i>High leverage outlier effects</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html#worked-example-7.3-structural-change-analysis"><i class="fa fa-check"></i>Worked Example 7.3: Structural Change Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html#visualizing-daily-flow"><i class="fa fa-check"></i>Visualizing Daily Flow</a></li>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html#testing-for-a-change-point"><i class="fa fa-check"></i>Testing for a change point</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html#worked-example-7.4-principal-component-analysis"><i class="fa fa-check"></i>Worked Example 7.4: Principal Component Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html#simple-pca-with-two-variables"><i class="fa fa-check"></i>Simple PCA with two variables</a></li>
<li class="chapter" data-level="" data-path="chapter-7.html"><a href="chapter-7.html#pca-with-all-variables"><i class="fa fa-check"></i>PCA with all variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-10.html"><a href="chapter-10.html"><i class="fa fa-check"></i>Chapter 10</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-10.html"><a href="chapter-10.html#worked-example-10.1-quantifying-effect-of-human-influences"><i class="fa fa-check"></i>Worked example 10.1: Quantifying effect of human influences</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-10.html"><a href="chapter-10.html#loading-the-data-10"><i class="fa fa-check"></i>Loading the data</a></li>
<li class="chapter" data-level="" data-path="chapter-10.html"><a href="chapter-10.html#threshold-calculation"><i class="fa fa-check"></i>Threshold calculation</a></li>
<li class="chapter" data-level="" data-path="chapter-10.html"><a href="chapter-10.html#benchmark-drought-characteristics"><i class="fa fa-check"></i>Benchmark Drought characteristics</a></li>
<li class="chapter" data-level="" data-path="chapter-10.html"><a href="chapter-10.html#human-influenced-drought-characteristics"><i class="fa fa-check"></i>Human-influenced drought characteristics</a></li>
<li class="chapter" data-level="" data-path="chapter-10.html"><a href="chapter-10.html#comparison-of-drought-characteristics"><i class="fa fa-check"></i>Comparison of drought characteristics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-12.html"><a href="chapter-12.html"><i class="fa fa-check"></i>Chapter 12</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-12.html"><a href="chapter-12.html#worked-example-12.2-drought-impact-model"><i class="fa fa-check"></i>Worked example 12.2: Drought Impact Model</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-12.html"><a href="chapter-12.html#data-1"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="chapter-12.html"><a href="chapter-12.html#preliminary-visual-comparison"><i class="fa fa-check"></i>Preliminary visual comparison</a></li>
<li class="chapter" data-level="" data-path="chapter-12.html"><a href="chapter-12.html#logistic-regression"><i class="fa fa-check"></i>Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="chapter-12.html"><a href="chapter-12.html#predicting-drought-impacts"><i class="fa fa-check"></i>Predicting drought impacts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-13.html"><a href="chapter-13.html"><i class="fa fa-check"></i>Chapter 13</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-13.html"><a href="chapter-13.html#worked-example-13.1-forecast-skill"><i class="fa fa-check"></i>Worked example 13.1: Forecast skill</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-13.html"><a href="chapter-13.html#loading-the-data-11"><i class="fa fa-check"></i>Loading the Data</a></li>
<li class="chapter" data-level="" data-path="chapter-13.html"><a href="chapter-13.html#calculate-long-term-low-flow-threshold-from-observations"><i class="fa fa-check"></i>Calculate long-term low flow threshold from observations</a></li>
<li class="chapter" data-level="" data-path="chapter-13.html"><a href="chapter-13.html#calculate-the-brier-score-bs"><i class="fa fa-check"></i>Calculate the Brier Score (BS)</a></li>
<li class="chapter" data-level="" data-path="chapter-13.html"><a href="chapter-13.html#calculate-the-brier-skill-score-bss"><i class="fa fa-check"></i>Calculate the Brier Skill Score (BSS)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio4edu/rstudio4edu-book" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hydrological Drought (2nd Edition)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-10" class="section level1">
<h1>Chapter 10</h1>
<div id="worked-example-10.1-quantifying-effect-of-human-influences" class="section level2">
<h2>Worked example 10.1: Quantifying effect of human influences</h2>
<p>If we want to quantify the human influence on hydrological drought by comparing two time series, one with and one without this human influence, we want to use the threshold of the <strong>benchmark</strong> time series to calculate droughts in both the <strong>human-influenced</strong> and <strong>benchmark</strong> time series. These are the steps that we will discuss in this Worked Example:</p>
<ol style="list-style-type: decimal">
<li><p>Calculate the threshold from the <strong>benchmark</strong> time series</p></li>
<li><p>Calculate <strong>benchmark</strong> drought characteristics for the <strong>benchmark</strong> time series with the <strong>benchmark</strong> threshold</p></li>
<li><p>Calculate <strong>human-influenced</strong> drought characteristics for the <strong>human-influenced</strong> time series with the <strong>benchmark</strong> threshold</p></li>
<li><p>Compare drought characteristics between the <strong>benchmark</strong> &amp; <strong>human-influenced</strong> time series</p></li>
</ol>
<div id="loading-the-data-10" class="section level3">
<h3>Loading the data</h3>
<p>As an example we here use the Upper-Guadiana dataset with the two time series: the <strong>benchmark</strong> time series and the <strong>human-influenced</strong> time series.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="chapter-10.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb176-2"><a href="chapter-10.html#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb176-3"><a href="chapter-10.html#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hydroDrought)</span>
<span id="cb176-4"><a href="chapter-10.html#cb176-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-5"><a href="chapter-10.html#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="do">### Filter to a specific period</span></span>
<span id="cb176-6"><a href="chapter-10.html#cb176-6" aria-hidden="true" tabindex="-1"></a>guadiana_period <span class="ot">&lt;-</span> guadiana <span class="sc">%&gt;%</span></span>
<span id="cb176-7"><a href="chapter-10.html#cb176-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(time, <span class="at">discharge =</span> Qsim) <span class="sc">%&gt;%</span></span>
<span id="cb176-8"><a href="chapter-10.html#cb176-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb176-9"><a href="chapter-10.html#cb176-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">year =</span> <span class="fu">water_year</span>(time)</span>
<span id="cb176-10"><a href="chapter-10.html#cb176-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb176-11"><a href="chapter-10.html#cb176-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1960</span>,  year <span class="sc">&lt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb176-12"><a href="chapter-10.html#cb176-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-13"><a href="chapter-10.html#cb176-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(guadiana_period)</span></code></pre></div>
<pre><code>## # A tibble: 14,976 x 3
##    time       discharge  year
##    &lt;date&gt;         &lt;dbl&gt; &lt;dbl&gt;
##  1 1960-01-01     0.153  1960
##  2 1960-01-02     0.148  1960
##  3 1960-01-03     0.144  1960
##  4 1960-01-04     0.14   1960
##  5 1960-01-05     0.136  1960
##  6 1960-01-06     0.133  1960
##  7 1960-01-07     0.13   1960
##  8 1960-01-08     0.128  1960
##  9 1960-01-09     0.129  1960
## 10 1960-01-10     0.139  1960
## # … with 14,966 more rows</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="chapter-10.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(guadiana_period<span class="sc">$</span>time)</span></code></pre></div>
<pre><code>## [1] &quot;1960-01-01&quot; &quot;2000-12-31&quot;</code></pre>
<p>The <strong>benchmark</strong> time series comprises the uninfluenced, naturalized discharge <span class="math inline">\(Q_{sim}\)</span>. Note that <strong>benchmark</strong> time series can be calculated from a paired catchment analysis, an upstream-downstream comparison, model naturalisation, or pre-post disturbance analysis (Sect. 10.4.1 and 10.5.1) or from model scenarios (Sect. 10.4.3, 4 and 10.5.3, 4). The <strong>benchmark</strong> time series for this catchment are modelled as described in Sect. XX.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="chapter-10.html#cb180-1" aria-hidden="true" tabindex="-1"></a>benchmark <span class="ot">&lt;-</span> guadiana_period  <span class="sc">%&gt;%</span></span>
<span id="cb180-2"><a href="chapter-10.html#cb180-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1981</span>,  year <span class="sc">&lt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb180-3"><a href="chapter-10.html#cb180-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 7,305 x 3
##    time       discharge  year
##    &lt;date&gt;         &lt;dbl&gt; &lt;dbl&gt;
##  1 1981-01-01     0.013  1981
##  2 1981-01-02     0.013  1981
##  3 1981-01-03     0.013  1981
##  4 1981-01-04     0.013  1981
##  5 1981-01-05     0.013  1981
##  6 1981-01-06     0.013  1981
##  7 1981-01-07     0.013  1981
##  8 1981-01-08     0.012  1981
##  9 1981-01-09     0.012  1981
## 10 1981-01-10     0.012  1981
## # … with 7,295 more rows</code></pre>
<p>The <strong>human-influenced</strong> time series is basically the time series of observed discharge <span class="math inline">\(Q_{obs}\)</span> from the Upper-Guadiana catchment.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="chapter-10.html#cb182-1" aria-hidden="true" tabindex="-1"></a>influenced <span class="ot">&lt;-</span> guadiana_period <span class="sc">%&gt;%</span></span>
<span id="cb182-2"><a href="chapter-10.html#cb182-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1991</span>,  year <span class="sc">&lt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb182-3"><a href="chapter-10.html#cb182-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3,653 x 3
##    time       discharge  year
##    &lt;date&gt;         &lt;dbl&gt; &lt;dbl&gt;
##  1 1991-01-01     0.019  1991
##  2 1991-01-02     0.019  1991
##  3 1991-01-03     0.018  1991
##  4 1991-01-04     0.018  1991
##  5 1991-01-05     0.018  1991
##  6 1991-01-06     0.017  1991
##  7 1991-01-07     0.017  1991
##  8 1991-01-08     0.017  1991
##  9 1991-01-09     0.017  1991
## 10 1991-01-10     0.017  1991
## # … with 3,643 more rows</code></pre>
</div>
<div id="threshold-calculation" class="section level3">
<h3>Threshold calculation</h3>
<p>Here we are taking the <code>benchmark</code> time series. First we are smoothing the column <code>discharge</code> with a 30-day moving average. The threshold itself is calculated as a daily varying <span class="math inline">\(Q_{80}\)</span> yielding a dataset with a row for each day of the year and the appropriate <span class="math inline">\(Q_{80}\)</span> in the column named <code>threshold</code>.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="chapter-10.html#cb184-1" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> guadiana_period <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="chapter-10.html#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># applying a 30-day moving average smoother</span></span>
<span id="cb184-3"><a href="chapter-10.html#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">discharge =</span> <span class="fu">moving_average</span>(discharge, <span class="at">n =</span> <span class="dv">30</span>, <span class="at">sides =</span> <span class="st">&quot;center&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb184-4"><a href="chapter-10.html#cb184-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb184-5"><a href="chapter-10.html#cb184-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># computing the Q80 for each day of the year</span></span>
<span id="cb184-6"><a href="chapter-10.html#cb184-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var_threshold</span>(<span class="at">vary.by =</span> <span class="st">&quot;day&quot;</span>, <span class="at">fun =</span> lfquantile, <span class="at">exc.freq =</span> <span class="fl">0.80</span>) </span>
<span id="cb184-7"><a href="chapter-10.html#cb184-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-8"><a href="chapter-10.html#cb184-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(threshold)</span></code></pre></div>
<pre><code>## # A tibble: 366 x 2
##       day threshold
##  * &lt;date&gt;     &lt;dbl&gt;
##  1 -01-01    0.0172
##  2 -01-02    0.0184
##  3 -01-03    0.0184
##  4 -01-04    0.0187
##  5 -01-05    0.0190
##  6 -01-06    0.0194
##  7 -01-07    0.0197
##  8 -01-08    0.0200
##  9 -01-09    0.0203
## 10 -01-10    0.0206
## # … with 356 more rows</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="chapter-10.html#cb186-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> threshold, <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> threshold)) <span class="sc">+</span> </span>
<span id="cb186-2"><a href="chapter-10.html#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>() <span class="sc">+</span> </span>
<span id="cb186-3"><a href="chapter-10.html#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">&quot;1 months&quot;</span>, <span class="at">date_labels =</span> <span class="st">&quot;%b&quot;</span>, </span>
<span id="cb186-4"><a href="chapter-10.html#cb186-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">expand =</span> <span class="fu">expansion</span>()) <span class="sc">+</span> </span>
<span id="cb186-5"><a href="chapter-10.html#cb186-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb186-6"><a href="chapter-10.html#cb186-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-7"><a href="chapter-10.html#cb186-7" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="chapter-10.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Add Julian date columns to the benchmark and threshold</span></span>
<span id="cb187-2"><a href="chapter-10.html#cb187-2" aria-hidden="true" tabindex="-1"></a>benchmark <span class="ot">&lt;-</span> benchmark <span class="sc">%&gt;%</span> </span>
<span id="cb187-3"><a href="chapter-10.html#cb187-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">jdate =</span> <span class="fu">yday</span>(time))</span>
<span id="cb187-4"><a href="chapter-10.html#cb187-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-5"><a href="chapter-10.html#cb187-5" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> threshold <span class="sc">%&gt;%</span> </span>
<span id="cb187-6"><a href="chapter-10.html#cb187-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">jdate =</span> <span class="fu">yday</span>(day), <span class="at">year =</span> <span class="fu">year</span>(day))</span>
<span id="cb187-7"><a href="chapter-10.html#cb187-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-8"><a href="chapter-10.html#cb187-8" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot the threshold against monthly flows in log10 space</span></span>
<span id="cb187-9"><a href="chapter-10.html#cb187-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(benchmark, <span class="fu">aes</span>(<span class="at">x=</span>jdate)) <span class="sc">+</span> </span>
<span id="cb187-10"><a href="chapter-10.html#cb187-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span>year, <span class="at">y=</span>discharge), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb187-11"><a href="chapter-10.html#cb187-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> threshold, <span class="fu">aes</span>(<span class="at">y=</span>threshold), <span class="at">colour=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb187-12"><a href="chapter-10.html#cb187-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Julian Date&quot;</span>, <span class="at">expand =</span> <span class="fu">expansion</span>()) <span class="sc">+</span></span>
<span id="cb187-13"><a href="chapter-10.html#cb187-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>()</span>
<span id="cb187-14"><a href="chapter-10.html#cb187-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-15"><a href="chapter-10.html#cb187-15" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="chapter-10.html#cb188-1" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> guadiana_period <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">jdate =</span> <span class="fu">yday</span>(time), <span class="at">line =</span> <span class="st">&quot;thresh_basis&quot;</span>, <span class="at">facet =</span> <span class="st">&quot;thresh_basis&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-2"><a href="chapter-10.html#cb188-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(benchmark <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">line =</span> <span class="st">&quot;benchmark&quot;</span>, <span class="at">facet =</span> <span class="st">&quot;benchmark&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb188-3"><a href="chapter-10.html#cb188-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(influenced <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">jdate =</span> <span class="fu">yday</span>(time), <span class="at">line =</span> <span class="st">&quot;influenced&quot;</span>, <span class="at">facet =</span> <span class="st">&quot;influenced&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb188-4"><a href="chapter-10.html#cb188-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(threshold <span class="sc">%&gt;%</span> <span class="fu">select</span>(jdate, threshold), <span class="at">by =</span> <span class="st">&quot;jdate&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-5"><a href="chapter-10.html#cb188-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">line =</span> <span class="fu">factor</span>(line, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;thresh_basis&quot;</span>, <span class="st">&quot;benchmark&quot;</span>, <span class="st">&quot;influenced&quot;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Threshold</span><span class="sc">\n</span><span class="st">Basis&quot;</span>, <span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Human</span><span class="sc">\n</span><span class="st">Influenced&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb188-6"><a href="chapter-10.html#cb188-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">facet =</span> <span class="fu">factor</span>(facet, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;thresh_basis&quot;</span>, <span class="st">&quot;benchmark&quot;</span>, <span class="st">&quot;influenced&quot;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Threshold Basis&quot;</span>, <span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Influenced&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb188-7"><a href="chapter-10.html#cb188-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="st">&quot;Threshold&quot;</span>)</span>
<span id="cb188-8"><a href="chapter-10.html#cb188-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-9"><a href="chapter-10.html#cb188-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-10"><a href="chapter-10.html#cb188-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x=</span>time)) <span class="sc">%&gt;%</span></span>
<span id="cb188-11"><a href="chapter-10.html#cb188-11" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>( <span class="at">y=</span>discharge, <span class="at">colour =</span> line)) <span class="sc">%&gt;%</span></span>
<span id="cb188-12"><a href="chapter-10.html#cb188-12" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> threshold), <span class="at">colour =</span> <span class="st">&quot;grey20&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-13"><a href="chapter-10.html#cb188-13" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">facet_grid</span>(facet<span class="sc">~</span>.) <span class="sc">%&gt;%</span></span>
<span id="cb188-14"><a href="chapter-10.html#cb188-14" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb188-15"><a href="chapter-10.html#cb188-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-16"><a href="chapter-10.html#cb188-16" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-153-2.png" width="672" /></p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="chapter-10.html#cb189-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x=</span>time)) <span class="sc">%&gt;%</span></span>
<span id="cb189-2"><a href="chapter-10.html#cb189-2" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>( <span class="at">y=</span>discharge, <span class="at">colour =</span> line)) <span class="sc">%&gt;%</span></span>
<span id="cb189-3"><a href="chapter-10.html#cb189-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">facet_grid</span>(facet<span class="sc">~</span>.)</span>
<span id="cb189-4"><a href="chapter-10.html#cb189-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-5"><a href="chapter-10.html#cb189-5" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-153-3.png" width="672" /></p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="chapter-10.html#cb190-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">&gt;=</span><span class="dv">1980</span> <span class="sc">&amp;</span> facet <span class="sc">!=</span> <span class="st">&quot;Threshold Basis&quot;</span>), <span class="fu">aes</span>(<span class="at">x=</span>jdate)) <span class="sc">%&gt;%</span></span>
<span id="cb190-2"><a href="chapter-10.html#cb190-2" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>( <span class="at">y=</span>discharge, <span class="at">colour =</span> line)) <span class="sc">%&gt;%</span></span>
<span id="cb190-3"><a href="chapter-10.html#cb190-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_step</span>(<span class="fu">aes</span>(<span class="at">y =</span> threshold, <span class="at">colour =</span> label), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb190-4"><a href="chapter-10.html#cb190-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">facet_grid</span>(year <span class="sc">~</span> facet, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb190-5"><a href="chapter-10.html#cb190-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;#377eb8&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Human</span><span class="sc">\n</span><span class="st">Influenced&quot;</span>, <span class="st">&quot;Threshold&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb190-6"><a href="chapter-10.html#cb190-6" aria-hidden="true" tabindex="-1"></a> <span class="co">#  + scale_x_date(date_breaks = &quot;1 month&quot;, date_labels = &quot;%b&quot;) %&gt;%</span></span>
<span id="cb190-7"><a href="chapter-10.html#cb190-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span>
<span id="cb190-8"><a href="chapter-10.html#cb190-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-9"><a href="chapter-10.html#cb190-9" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-153-4.png" width="672" /></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="chapter-10.html#cb191-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">&gt;=</span><span class="dv">1980</span> <span class="sc">&amp;</span> facet <span class="sc">!=</span> <span class="st">&quot;Threshold Basis&quot;</span>), <span class="fu">aes</span>(<span class="at">x=</span>jdate)) <span class="sc">%&gt;%</span></span>
<span id="cb191-2"><a href="chapter-10.html#cb191-2" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>( <span class="at">y=</span>discharge, <span class="at">colour =</span> line)) <span class="sc">%&gt;%</span></span>
<span id="cb191-3"><a href="chapter-10.html#cb191-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_step</span>(<span class="fu">aes</span>(<span class="at">y =</span> threshold, <span class="at">colour =</span> label), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb191-4"><a href="chapter-10.html#cb191-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">facet_grid</span>(year <span class="sc">~</span> facet, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb191-5"><a href="chapter-10.html#cb191-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;#377eb8&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;Benchmark&quot;</span>, <span class="st">&quot;Human</span><span class="sc">\n</span><span class="st">Influenced&quot;</span>, <span class="st">&quot;Threshold&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb191-6"><a href="chapter-10.html#cb191-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#+ scale_x_date(date_breaks = &quot;1 month&quot;, date_labels = &quot;%b&quot;) %&gt;%</span></span>
<span id="cb191-7"><a href="chapter-10.html#cb191-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">scale_y_log10</span>() <span class="sc">%&gt;%</span></span>
<span id="cb191-8"><a href="chapter-10.html#cb191-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">theme_bw</span>(<span class="dv">8</span>)</span>
<span id="cb191-9"><a href="chapter-10.html#cb191-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-10"><a href="chapter-10.html#cb191-10" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-153-5.png" width="672" /></p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="chapter-10.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(benchmark, <span class="fu">aes</span>(<span class="at">x=</span>time)) <span class="sc">%&gt;%</span></span>
<span id="cb192-2"><a href="chapter-10.html#cb192-2" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>( <span class="at">y=</span>discharge)) <span class="sc">%&gt;%</span></span>
<span id="cb192-3"><a href="chapter-10.html#cb192-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> benchmark <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(threshold, <span class="at">by =</span> <span class="st">&quot;jdate&quot;</span>), <span class="fu">aes</span>(<span class="at">y=</span>threshold), <span class="at">colour=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-153-6.png" width="672" /></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="chapter-10.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot the threshold against monthly flows in log10 space</span></span>
<span id="cb193-2"><a href="chapter-10.html#cb193-2" aria-hidden="true" tabindex="-1"></a>ya <span class="ot">&lt;-</span>  benchmark <span class="sc">%&gt;%</span></span>
<span id="cb193-3"><a href="chapter-10.html#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">discharge =</span> <span class="fu">moving_average</span>(discharge, <span class="at">n =</span> <span class="dv">30</span>, <span class="at">sides =</span> <span class="st">&quot;center&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb193-4"><a href="chapter-10.html#cb193-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1960</span>,  year <span class="sc">&lt;=</span> <span class="dv">2000</span>)</span>
<span id="cb193-5"><a href="chapter-10.html#cb193-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-6"><a href="chapter-10.html#cb193-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ya <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(), <span class="fu">aes</span>(<span class="at">x=</span>jdate)) <span class="sc">+</span> </span>
<span id="cb193-7"><a href="chapter-10.html#cb193-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span>year, <span class="at">y=</span>discharge), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb193-8"><a href="chapter-10.html#cb193-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> threshold, <span class="fu">aes</span>(<span class="at">y=</span>threshold), <span class="at">colour=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb193-9"><a href="chapter-10.html#cb193-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Julian Date&quot;</span>, <span class="at">expand =</span> <span class="fu">expansion</span>()) <span class="sc">+</span> </span>
<span id="cb193-10"><a href="chapter-10.html#cb193-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>()</span>
<span id="cb193-11"><a href="chapter-10.html#cb193-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-12"><a href="chapter-10.html#cb193-12" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-153-7.png" width="672" /></p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="chapter-10.html#cb194-1" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> threshold <span class="sc">%&gt;%</span> </span>
<span id="cb194-2"><a href="chapter-10.html#cb194-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>jdate, <span class="sc">-</span>year)</span></code></pre></div>
</div>
<div id="benchmark-drought-characteristics" class="section level3">
<h3>Benchmark Drought characteristics</h3>
<p><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="chapter-10.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize empty list for events</span></span>
<span id="cb195-2"><a href="chapter-10.html#cb195-2" aria-hidden="true" tabindex="-1"></a>events <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">benchmark =</span> <span class="cn">NULL</span>, <span class="at">influenced =</span> <span class="cn">NULL</span>)</span>
<span id="cb195-3"><a href="chapter-10.html#cb195-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-4"><a href="chapter-10.html#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize empty list for final drought characteristics</span></span>
<span id="cb195-5"><a href="chapter-10.html#cb195-5" aria-hidden="true" tabindex="-1"></a>drought.char <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">benchmark =</span> <span class="cn">NULL</span>, <span class="at">influenced =</span> <span class="cn">NULL</span>) </span>
<span id="cb195-6"><a href="chapter-10.html#cb195-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-7"><a href="chapter-10.html#cb195-7" aria-hidden="true" tabindex="-1"></a><span class="co"># function that computes the drought characteristics given a table of events</span></span>
<span id="cb195-8"><a href="chapter-10.html#cb195-8" aria-hidden="true" tabindex="-1"></a>summarize_dc <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb195-9"><a href="chapter-10.html#cb195-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;mean.duration&quot;</span> <span class="ot">=</span> <span class="fu">as.double</span>(<span class="fu">mean</span>(x<span class="sc">$</span>duration)), </span>
<span id="cb195-10"><a href="chapter-10.html#cb195-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;mean.deficit&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(x<span class="sc">$</span>volume))</span>
<span id="cb195-11"><a href="chapter-10.html#cb195-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Periods with discharges below the before calculated threshold are considered drought events. Consecutive drought events with an inter-event time of less than or equal to 10 days (argument <code>min.duration = 10</code>) get pooled into a single drought event regardless of their inter-event excess volume (argument <code>min.vol.ratio = Inf</code>). To get rid of minor droughts, only drought events with a duration of more than 10 days are kept.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="chapter-10.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the drought events for the benchmark time series</span></span>
<span id="cb196-2"><a href="chapter-10.html#cb196-2" aria-hidden="true" tabindex="-1"></a>events<span class="sc">$</span>benchmark <span class="ot">&lt;-</span> benchmark <span class="sc">%&gt;%</span></span>
<span id="cb196-3"><a href="chapter-10.html#cb196-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1981</span>, year <span class="sc">&lt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb196-4"><a href="chapter-10.html#cb196-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drought_events</span>(</span>
<span id="cb196-5"><a href="chapter-10.html#cb196-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">threshold =</span> threshold,</span>
<span id="cb196-6"><a href="chapter-10.html#cb196-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pooling =</span> <span class="st">&quot;inter-event&quot;</span>,</span>
<span id="cb196-7"><a href="chapter-10.html#cb196-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pooling.pars =</span> <span class="fu">list</span>(<span class="at">min.duration =</span> <span class="dv">10</span>, <span class="at">min.vol.ratio =</span> <span class="cn">Inf</span>)</span>
<span id="cb196-8"><a href="chapter-10.html#cb196-8" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span></span>
<span id="cb196-9"><a href="chapter-10.html#cb196-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(duration <span class="sc">&gt;</span> <span class="dv">10</span>)</span>
<span id="cb196-10"><a href="chapter-10.html#cb196-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-11"><a href="chapter-10.html#cb196-11" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the drought characteristics for the benchmark time series</span></span>
<span id="cb196-12"><a href="chapter-10.html#cb196-12" aria-hidden="true" tabindex="-1"></a>drought.char<span class="sc">$</span>benchmark <span class="ot">&lt;-</span> <span class="fu">summarize_dc</span>(events<span class="sc">$</span>benchmark)</span></code></pre></div>
<p>For the Upper-Guadiana, these would be the drought events of the <strong>benchmark</strong> time series. Note that this calculation can be applied for a different time period than was used to calculate the <strong>benchmark</strong> threshold (for example, for Upper-Guadiana, we are using the period 1981-2000). Events numbers that are missing in the sequence are minor drought events that have been filtered out.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="chapter-10.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(events<span class="sc">$</span>benchmark)</span></code></pre></div>
<pre><code>## # A tibble: 32 x 9
##    event first.day  last.day   duration dbt       volume  qmin tqmin      pooled
##    &lt;int&gt; &lt;date&gt;     &lt;date&gt;     &lt;drtn&gt;   &lt;drtn&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
##  1     1 1981-01-01 1981-04-22 112 days 112 days 100349. 0.01  1981-02-04      0
##  2     2 1981-06-09 1981-12-28 203 days 187 days  84024. 0     1981-11-23      4
##  3     5 1982-05-01 1982-06-01  32 days  30 days   7235. 0.017 1982-05-25      1
##  4     6 1982-06-25 1982-10-19 117 days 106 days  14406. 0     1982-10-07      3
##  5     7 1983-01-31 1983-11-22 296 days 296 days 202991. 0     1983-09-20      0
##  6     8 1983-12-03 1983-12-17  15 days  15 days   5915. 0.009 1983-12-13      0
##  7     9 1984-02-17 1984-02-27  11 days  11 days   3787. 0.018 1984-02-22      0
##  8    10 1984-10-22 1984-11-03  13 days  11 days    533. 0.007 1984-10-22      1
##  9    12 1985-10-12 1985-12-25  75 days  66 days  17653. 0.004 1985-11-12      2
## 10    13 1986-11-29 1987-01-11  44 days  44 days  22026. 0.009 1987-01-08      0
## # … with 22 more rows</code></pre>
</div>
<div id="human-influenced-drought-characteristics" class="section level3">
<h3>Human-influenced drought characteristics</h3>
<p>We will now do the same drought calculation on the human-influenced time series, using the same period as for the benchmark drought calculation (here: 1981-2000).</p>
<p><img src="_main_files/figure-html/unnamed-chunk-157-1.png" width="768" /></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="chapter-10.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the drought events for the human influenced time series</span></span>
<span id="cb199-2"><a href="chapter-10.html#cb199-2" aria-hidden="true" tabindex="-1"></a>events<span class="sc">$</span>influenced <span class="ot">&lt;-</span> influenced <span class="sc">%&gt;%</span></span>
<span id="cb199-3"><a href="chapter-10.html#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1991</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb199-4"><a href="chapter-10.html#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drought_events</span>(<span class="at">threshold =</span> threshold,</span>
<span id="cb199-5"><a href="chapter-10.html#cb199-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pooling =</span> <span class="st">&quot;inter-event&quot;</span>,</span>
<span id="cb199-6"><a href="chapter-10.html#cb199-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pooling.pars =</span> <span class="fu">list</span>(<span class="at">min.duration =</span> <span class="dv">10</span>, <span class="at">min.vol.ratio =</span> <span class="cn">Inf</span>))  <span class="sc">%&gt;%</span></span>
<span id="cb199-7"><a href="chapter-10.html#cb199-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(duration <span class="sc">&gt;</span> <span class="dv">10</span>)</span>
<span id="cb199-8"><a href="chapter-10.html#cb199-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-9"><a href="chapter-10.html#cb199-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the drought characteristics for the human influenced time series</span></span>
<span id="cb199-10"><a href="chapter-10.html#cb199-10" aria-hidden="true" tabindex="-1"></a>drought.char<span class="sc">$</span>influenced <span class="ot">&lt;-</span> <span class="fu">summarize_dc</span>(events<span class="sc">$</span>influenced)</span></code></pre></div>
</div>
<div id="comparison-of-drought-characteristics" class="section level3">
<h3>Comparison of drought characteristics</h3>
<p>For the Upper-Guadiana, these would be the drought characteristics:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="chapter-10.html#cb200-1" aria-hidden="true" tabindex="-1"></a>drought.char</span></code></pre></div>
<pre><code>## $benchmark
## mean.duration  mean.deficit 
##      90.59375   57967.00200 
## 
## $influenced
## mean.duration  mean.deficit 
##      97.23529   77893.12376</code></pre>
<p>Calculate the percentage difference between the <strong>benchmark</strong> and <strong>human-influenced</strong> drought characteristics.</p>
<p><span class="math display">\[\Delta DC = \frac{DCHI - DCBM}{DCBM} \cdot 100\]</span>
where <span class="math inline">\(\Delta DC\)</span> is the percentage change in drought characteristics (<span class="math inline">\(DC\)</span>) between the <strong>human-influenced</strong> (<span class="math inline">\(DCHI\)</span>) and <strong>benchmark</strong> (<span class="math inline">\(DCBM\)</span>) time series.
For the Upper-Guadiana, these would be the differences in drought characteristics:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="chapter-10.html#cb202-1" aria-hidden="true" tabindex="-1"></a>(drought.char<span class="sc">$</span>influenced <span class="sc">-</span> drought.char<span class="sc">$</span>benchmark) <span class="sc">/</span> drought.char<span class="sc">$</span>benchmark <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>## mean.duration  mean.deficit 
##      7.331128     34.374939</code></pre>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Tobias: I think this Worked Example could be easier to follow if we fist compute the drought events for both time series and in a separate section the drought characteristics. So section 2 could become “Drought Events”, Section 3 “Drought Characteristics”.<a href="chapter-10.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-7.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-12.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jstagge/hydroDrought/master/docs/10-chapter10.Rmd",
"text": ""
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
